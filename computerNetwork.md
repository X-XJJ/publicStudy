结合图像理解！！脑子里要有动态图、过程图！！

# 一、体系结构
- 协议：语意，语法，时序
- 接口：SAP System Applications and Products？？
- 服务：面向连接/无连接，可靠/不可靠-尽最大努力，有应答/无应答
## 一些概念
- 计算机网络：互联的、自治的计算机系统集合
- 组成
  - 组成成分 =｛硬件，软件，协议｝
  - 工作方式 =｛边缘，核心｝
  - 功能组成 =｛通信子网，资源子网｝
- 功能：数据通信，资源分享，分布式处理，提高可靠性，负载均衡
- 分类
  - 分布范围-万慢懒胖：Wide、Metropolitan、Local、Personal Area Network
    - 广域网WAN，城域网MAN，局域网LAN，个人区域网PAN
  - 传输技术：广播式网络，点对点网络
  - 拓扑结构：星型，总线型，环形，网状型
  - 使用者：公用网，专用网
  - 交换技术：电路交换网，报文交换-存储转发网，分组交换-包交换网
  - 传输介质：无线，有线，双绞线，同轴电缆，光纤，...
- 主要性能指标（7个）
  - 速率：码元传输速率，数据传输速率，单位 b/s、kb/s、Mb/s、Gb/s，换算10^3
    - 传输速率 = 发送的快慢
    - 传播速率 = 电磁波信道中传播速度
  - 带宽：频带宽度Hz，最高数据率b/s，bps是啥来着？？，信道所能达到的的传输速率极限
  - 吞吐量 = 在单位时间内实际通过某个网络（或信道、接口）的数据量
  - 时延 = 发送/传输时延 + 传播时延 + 处理时延 + 排队时延
    - 发送or传输时延 = 分组长度/信号宽度（？理解 柱高=体积/底面积）
    - 传播时延 = 信道长度/电磁波在信道上的传播速率（时间=距离/速度）
  - 时延带宽积 = 传播时延 ×带宽 = 该管道可容纳的比特数量
  - 往返时延RTT Round-Trip-Time = 从发送方发送数据开始，到发送方收到接收方的确认（接收方收到数据后立即发送确认）总共经历的时延
  - 利用率：信道利用率
## 分层的体系结构
- 分层依据原则：实现独立功能，交互流少，上层对下层独立，标准化，...
- 报文分类 = 数据部分SDU报文 + 控制信息部分报文
  - 控制信息部分：PCI PDU
    - PCI总线？？
    - PDU 协议数据单元 Protocol-Data-Unit
      - 对等层次之间传递的数据单位
      - 物理层-比特，数据链路层-帧，网络层-分组，传输层-报文
  - 报文逐层封装，高层报文为低层的数据部分
- 层次结构：N层使用N-1以下服务，N层为N+1以上服务
- 七层 OSI 开放系统互联 Open-System-Interconnection
  - 物理层 - 数据链路层 - 网络层 - 传输层 - 会话层 - 表示层 - 应用层
- 四层 TCP/IP
  - 网络接口层（物理+数据链路） - 网际层 - 传输层 - 应用层（会话+表示+应用）
- 五层 综合使用
  - 物理层 - 数据链路层 - 网络层 - 传输层 - 应用层
- 概述五层
  - 物理层：介质命名与识别，单位为bit，传输比特流，信号的编码、译码，标准EIA-232C等
  - 数据链路层：点到点通信，单位为帧，差错控制、流量控制、传输管理，MAC、LLC子层，协议PPP、STP、SDLC、HDLC等
    - LLC = 数据链路层上层-逻辑链路控制，Logical Link Control
    - MAC = 数据链路层下层-介质访问控制，Media Access Control
  - 网络层：主机间通信，单位为数据报，差错控制、流量控制、拥塞控制，协议IPv4/6、ICMP、ARP、OSPF、RARP等
  - 传输层：主机间两个进程通信，单位为TCP报文段、DP用户数据报，差错控制、流量控制、端到端可靠连接、数据传输管理、服务质量，协议TCP、UDP
  - 应用层：协议FTP、HTTP、POP3、SMTP、IMAP等

# 二、物理层
## 通信相关
- 数据形式：数字，模拟
- 传输方式：串行，并行
- 数据通信系统：信源-数据源头，信宿-数据终点，信道
  - 信道分类
    - 传输媒介：传输信号-数字or模拟，传输介质-有线or无线
    - 传输形式：基带/宽带
    - 信息交互方式：单工/半双工/全双工
- 奈奎斯特定理？？
  - V = 2W·log₂(V)，理想低通信道条件下的极限传输率
  - 码元传输的速率受限，限定W，V →极限传输率
- 香农定理？？
  - V = W·log₂(1 + S/N)，
  - 信息传输速率的极限，限定W，S/N →极限传输率，考虑信噪比
  - 信噪比 = 10·log(10)(S/N)分贝，香农公式中需转化为非分贝的S/N
- 编码、调制
  - 数-数
    - 非归零码：两个不同电压 = 0、1
    - 曼彻斯特编码：高to低 = 0，反过来 = 1 = 低to高，同轴电缆/双绞线/光纤
    - 差分曼彻斯特：前半电平 与 上个码元的后半个码元，相同 = 0，不同 = 1，自带同步，抗干扰
    - 4B/5B编码
  - 数-模
    - ASK，振幅区别01，振幅键控，调幅？
    - FSK，频率区别01，调频？
    - PSK，相位区别01，调相？
    - QAM，正交结合ASK、PSK
  - 模-数
    - PCM 脉冲编码调制：抽样，量化，编码；Pulse-Code-Modulation
    - 采样定理：采样频率 ≥最大频率的两倍，保证信号完整还原
  - 模-模：频分复用FDM、还原
## 交换、传输介质、设备
- 交换方式：电路交换，报文交换，分组交换
  - 报文交换：存储转发，报文携带原地址、目的地址等信息
  - 分组交换：存储转发，大数据块划分为固定小块
    - 数据报：无连接-不可靠-最大努力-不保证有序到达
    - 虚电路：有连接-可靠-建立连接后报文不需地址-保证有序
- 传输介质：非导向、导向
  - 导向传输介质：
    - 同轴电缆：10BASE，10M/s，总线型，百米级，曼彻斯特编码
    - 双绞线：100BASE，100M/s，星型，百米级，曼彻斯特编码
    - 光纤：1000BASE，1Gb/s，点对点，千米级，曼彻斯特编码
    - 无线：无线电波，微波、红外、激光
- 传输设备
  - 中继器-串联不超过4个，放大器，集线器 = 多端口中继器

# 三、数据链路层
- 功能：为网络层提供服务
  - 无确认无连接-以太网，有确认无连接-无线通信，有确认面向连接-通信要求高
  - 链路管理：建立，维持，释放
  - 帧相关：帧定界，帧同步，透明传输
  - 流量控制：反馈，控制相邻两节点之间的数据链路流量
  - 差错控制：位错-CRC校验，帧错-｛丢失-定时器机制，重复-帧编号｝
- 组帧
  - 字符计数法：计数说明帧内字节数
  - 字符填充的首位定界法：特殊字符定界开始+结束
  - 比特填充法：0111110 标志帧开始+结束，数据中出现5个1就在后面添0
  - 违规编码法：利用冗余编码，IEEE 802采用
- 设备：能隔离冲突域
  - 网桥：多个以太网连接为一个网段，透明网桥-非最佳路由，源路由网桥-最佳路由
  - 交换机：多端口网桥，本网段内-直通式，不同网段-存储转发
## 差错控制
- 检错编码，自动重传ARQ，发现错误重新传
  - 奇偶校验码
  - CRC 循环冗余校验，Cyclic-Redundancy-Check
    - 通常根据网络数据包数据产生简短固定位数校验码的一种散列函数，主要用途：错误侦测，检测或校验数据传输或者保存后是否出错，基于除留余数
    - 原理：校验码即余数 = 信息码后添加冗余位 mod 生成多项式码
    - 校验码位数 = 冗余位位数 = 生成多项式位数 - 1，冗余位全取值为0，校验码位数算出来不够则在前面补0
    - 二进制模2除法，即异或
    - 发送方：使用原理计算出校验码，信息码后添加校验码，发送
    - 接收方：(信息码+校验码) mod 生成多项式码 = 0
    - 多项式对应二进制数
      - eg：G(x) = X^4 + X^3 + 0 ·X^2 + X + 1
      - <=> G(x) = X^4 + X^3 + X + 1
      - <=> 11011
- 纠错编码，前向纠错FEC，发现错误纠正
  - 海明码？？
- 其他编码
  - 累加校验码
  - 因特网校验？
## 流量控制、可靠传输机制
- 可靠传输机制：确认 + 超时重传
- 自动重传请求 ARQ Automatic-Repeat-reQues
  - 停止等待协议(1,1)
  - GBN 后退N帧ARQ协议：滑动窗口 + 后退N帧，(1, (2^n)-1)；Go-Back-N ARQ
  - SR协议：滑动窗口 + 选择重传，(2^(n-1), 2^(n-1))
## 介质访问控制
- 信道划分 Frequency/Time/Wavelength/code-division-multiplexing
  - FDM-频分多路复用，TDM-时分多路，WDM-波分多路，CDM-码分多路-正交向量内积=0
- 随机访问协议：争用信道，尽可能避免冲突
  - Aloha协议：最早的无线数据通信协议
  - 时隙Aloha协议，每个时隙开始才能发送帧
  - CSMA 载波侦听多路访问 Carrier-Sense-Multiple-Access
    - 1-坚持CSMA：
    - 非坚持CSMA：
    - p-坚持CSMA：信道空闲时每个时隙以p的概率发送数据
  - CSMA/CD ~/冲突检测 Collision-Detection
    - 用于有线网络，总线以太网，载波侦听、碰撞检测
    - 先听后发、边听边发、冲突停发、随机重发
    - 总线传播时延影响大，2T内无法确定争用期，最小帧长原理
    - 进制数退避算法，重传次数↑，则推迟的时间范围↑
  - CSMA/CA ~/冲突避免 Collision-Avoidance
    - 用于无线网络，无线局域网802，碰撞避免
    - 实现碰撞避免：二进制指数退避算法，预约信道，ACK帧，RTS/CTS帧
    - ACK = 确认字符，Acknowledge-Character
    - RTS/CTS = 请求发送/允许发送协议，Request-To-Send/Clear-To-Send
  - 轮询访问：令牌传递协议，令牌环局域网
## 局域网 LAN
- 涉及OSI下两层（物理 + 数据链路），强调资源共享
- 常见拓扑：星型，环形，总线型，星型总线结合型
- 传输介质：双绞线，铜缆，光纤
- 介质访问的控制方法：CSMA/CD，令牌总线，令牌环
- 特殊的LAN、拓扑
  - 以太网
    - 逻辑-总线型，物理-星型or扩展星型，IEEE 802.3
    - 广播发送信息，MTU限制1500字节，最小帧长64B
    - 无连接，不可靠，尽最大努力交付
  - 高速以太网：100BASE-T-半全都支持，吉比特-半全都支持，10吉比特-只用光纤+全双工
  - 令牌环网
    - 逻辑-环形，物理-星型，IEEE 802.5
    - 本质是特殊格式的MAC控制帧，公平所有入网计算机访问权
  - FDDI：逻辑-环形，物理-双环，IEEE 802.8
- IEEE 802 的子层划分
  - MAC向下，向上层屏蔽下层差异，向下层提供统一访问接口
  - LLC向上，提供不同的连接服务类型 =｛无连接，面向连接，带确认无连接，高速传送｝
- IEEE 802.11 对应无限局域网
  - 有固定基础设施：基站-无线访问接入点-AP Wireless Access-Point，基本服务集-BSS Basic-Service-Set，移动站，AP接入主干分配系统DS-扩展服务集ESS
  - 无固定基础设施：AD-Hoc-平等
- 网络接口卡NIC 网络接口控制器-网络适配器-网卡 Network-Interface Controller/Card
  - 每块网卡对应唯一MAC地址，工作于物理层，控制主机对介质访问
## 广域网 WAN
- 涉及OSI下三层（物理 + 数据链路 + 网络），强调数据传输
- 交换机组成节点，只能连通同类型网络 ≠互联网
- 核心问题：路由选择，分组转发
- 协议
  - PPP 点对点协议 Point-to-Point-Protocol
    - 面向字节，由LCP NCP组成，将IP数据报分装到串行链路
    - LCP 链路控制协议，向下建立和管理链路，Link-Control-Protocol
    - NCP 网络控制协议，向上为多种网络提供服务，Network-Control-Protocol
  - HDLC
    - 面向比特，配置方式-平衡/非平衡，站类型-主站/从站/复合站，响应方式-正常响应/异步平衡/异步响应

# 四、网络层
- 异构网络互联：TCP/IP在网络层采用统一的标准化协议，形成忽略下层差异的虚拟互联网络
- 中继系统层次
  - 物理层：    中继器，集线器Hub
  - 数据链路层：网桥or交换机
  - 网络层：    路由器
  - 网络层以上：网关
- 路由器功能
  - 路由选择：获取整个网络拓扑的变化，得出路由表，动态地确定路径
  - 分组转发：根据转发表从合适的端口转发IP数据报分组
  - 路由器互联多个网络，有多个IP地址，多个硬件地址
- 拥塞控制
  - 拥塞：出现过量的分组，引起网络性能下降（观察吞吐量&网络负载水平是否相一致）
  - 开环：静态预防，运行过程中不修改
  - 闭环：动态监测，基于反馈环路，实时监测网络系统，检测拥塞并解决，ICMP差错报文-源点抑制实现
  - 与“流量控制”区别
    - 流量控制：发送端、接收端之间，点对点通信量的控制
    - 拥塞控制：通信子网之内，保证能够传送待传送的数据
- 路由算法
  - 静态路由/非自适应路由算法：管理员手工配置
  - 动态路由算法/自适应路由算法
    - 距离-向量算法
      - 结点与直接邻居交换信息，交换整个路由选择表，得到最短（最小代价）通路，可能出现环路问题
      - 路由选择表 = {每条路径目的地，路径代价/距离}
      - 常见算法：RIP-“跳数”为路径距离
    - 链路状态算法
      - 结点与全网结点广播交换信息，交换自己的直接链路状态，用Dijsktra算法计算最短路径
      - 每个结点主动检测邻接结点状态，定期将自己的链路状态传播给all结点
      - 链路状态 = {本结点相邻路由器，该链路的度量}
      - 常见算法：OSPF-费用、距离、时延、带宽等为度量
- 层次路由
  - 内部网关协议IGP/域内路由选择：自治系统内使用，如RIP，OSPF
  - 外部网关协议EGP/域间路由选择：自治系统间使用，如BGP Exterior-Gateway-Protocol
## IPv4、IPv6
- 分组转发
  - IP数据报分片
  - 根据不同下层网络对数据长度的限制，每个路由都有可能分片
    - 数据链路层的最大传送单元MTU，以太网MTU = 1500字节，广域网MTU≤567字节
  - 首部定长：20字节（20B=160b）
    - 4b版本号
    - 4b首部长度，计算单位为4B
    - 8b区分服务
    - 16b总长度：IP数据报封装成帧必须≤以太网成帧的最大传送单元MTU=1500B
    - 16b标识：同一数据报分片之后的标识号相同，不同数据报的标识加一
    - 3b标志：第二位为DF Don't-Fragment，最低位为MF More-Fragment
      - DF = 0 表示允许分片
      - MF = 1 表示其后还有分片，MF = 0 表示是该数据报的最后一个分片
    - 13b片偏移：13位，记录该分片在原分组中的相对位置
    - 8b生存时间TTL：8位，表示数据报在网络中可通过的路由器数的最大值
    - 8b协议：8位，6表示TCP，17表示UDP
    - 16b首部检验和：16位，只校验分组首部，不验数据部分
    - 32b源地址：32位，目的地址占32位
    - 注：IP数据报首部关于长度的标记数，有其各自的计算单位
      - “首部长度”单位为4B，“总长度”单位为1B，“片偏移”单位为8B，如片偏移为3，则片偏移实长24B
  - 转发：直连-直接交付，非直连-间接交付
- IPv4地址
  - IPv4地址::= {<网络号>, <主机号>}，共32位 = 4字节 = 4B，一般用点分十进制法表示
  - 分五类的IP地址（等着改成表格的）
    - A类：类别位 0   ，网络号1B 1.~126.            ，网络数 2^7 - 2 ，容纳主机数 2^24 - 2
    - B类：类别位 10  ，网络号2B 128.1.~191.255.    ，网络数 2^14 - 2，容纳主机数 2^14 - 1，2^16 - 2
    - C类：类别位 110 ，网络号3B 192.0.1~223.255.255，网络数 2^21 - 2，容纳主机数 2^8 - 2
    - D类：类别位 1110，无网络号 224.~239.          ，多播地址
    - E类：类别位 1111，无网络号 240.~255.          ，保留为今后使用
  - 特殊地址
    - 主机号全0：本网络本身，如B类的128.1.0.0
    - 主机号全1：广播
    - 127.0.0.0：本地环路自检
    - 0.0.0.0：本网络上的本主机
    - 255.255.255.255：本网络的整个TCP/IP网络的广播地址，实际受限于广播域的隔离
  - 构成：网络号-地址类决定，子网号-子网掩码决定，主机号，子网掩码
- 网络地址转换 NAT
  - 划出一部分IP地址为私有地址，NAT将私有网段（专用网内部的可重用地址）转换为公用地址
  - 只用于局域网LAN，NAT转换表-实现内部地址与全球IP地址对应，即 {本地IP:端口} 映射 {全球IP:端口}
  - 已经到端口，NAT工作在传输层
  - A类划出：10.0.0.0 ~ 255.255.255.255
  - B类划出：172.16.0.0 ~ 172.31.255.255
  - C类划出：192.168.0.0 ~ 192.168.255.255
- 子网划分
  - 划分子网：从**主机号**借若干位作为子网号，IP地址 = {<网络号>, <子网号>, <主机号>}
  - 子网掩码
    - 与IP地址对应的32bit二进制串，由连续的1和连续的0组成，1对应网络号、子网号，0对应主机号
    - 子网内的网络地址 = 网络号|子网号 = IP地址、子网掩码的对应位“逐位相与”（逻辑AND）
    - 默认子网掩码：A类地址 255.0.0.0，B类地址 255.255.0.0，C类地址 255.255.255.0
- 无分类编址 CIDR
  - 取消网络分类，灵活分组，将叫嚣的网络 聚合为超网
  - IP地址 ::= {<网络前缀>, <主机号>}，网络前缀所占比特数 = 子网掩码中为1的部分
  - 斜线记法/CIDR记法：“IP地址/网络前缀所占比特数”，如192.168.0.1/23
  - 路由聚合/构成超网：网络前缀有相同部分的连续IP地址可组成“CIDR地址块”，一个CIDR地址块可表多组地址
    - 如 206.1.0.0/17 和 206.1.128.0/17 可聚合为 206.1.0.0/16
  - 最长前缀匹配/最佳匹配：查找路由表时若匹配到多个路由结果，则选择网络前缀最长的路由进行转发
- 协议
  - ARP  地址解析协议 Address-Resolution-Protocol
    - ARP表 = IP →MAC 映射表，工作在网络层
    - 若查找不到映射，则发送广播ARP请求分组（MAC地址全1），对应主机响应单播ARP分组，后再发数据
  - RARP 逆地址解析协议：MAC →IP 转化
  - DHCP 动态主机配置协议 Dynamic-Host-Configuration-Protocol
    - C/S方式（客户/服务器），∴是应用层协议，基于UDP，给主机动态分配IP
    - 同一网络允许多个DHCP服务器，DHCP客户机在多个应答中挑一个
      - DHCP客户机广播“DHCP发现”→
      - DHCP服务器收到后、广播“DHCP提供”、含提供的IP信息→
      - DHCP客户机收到后、接收此IP、广播“DHCP请求”→
      - DHCP服务器收到后、广播“DHCP确认”分配IP
  - ICMP 网际控制报文协议 Internet-Control-Message-Protocol
    - IP层协议，ICMP报文放在IP数据报的数据部分
    - ICMP差错报文-5类：终点不可达，源点抑制-实现拥塞控制，超时-依据TTL-tracert/traceroute，参数问题，改变路由
    - ICMP询问报文-4类：回送请求和回答-分组网间探测ping，时间戳请求和回答，掩码地址请求和回答，路由器询问和通告
- IPv6
  - 解决IP耗尽方法：CIDR，NAT，IPv6-根本解决
  - 128 bit = 16字节，不允许分片
  - 表示：每4位用一个十六进制数表示，冒号分隔每个16位，如 4BF5:AA12:0216:FEBC:BA5F:039A:BE9A:2170
  - IPv6的目的地址：单播-传统点对点，多播-一对多，任播-一对一组
  - IPv4 过渡 IPv6：双协议栈，隧道技术
## 路由协议
- 自治系统 AS
- 自治系统内部：内部网关协议IGP，含有——
  - RIP 路由信息协议 Routing Information Protocol
    - 距离-向量算法
    - 应用层协议，基于UDP，端口 520
    - 选择的路径跳数最少
    - 只和相邻路由交换信息，定期交换，交换整个路由表
    - 限制规模，最大距离15，16表不可达
    - 慢收敛，坏消息传播慢，可能环路
  - OSPF 开放式最短路径优先 Open Shortest Path First
    - 链路状态算法
    - 网络层协议，基于IP数据报
    - 洪泛法，设置不同的代价灵活选择，基于Dijkstra最短路径算法构建全网拓扑结构图
    - 整个自治系统内部交换，发生变化时交换，交换与自己直接相连的链路&代价
    - 规模可扩充，可划分多层
    - 可实现多路负债平衡
- 自治系统之间：边界网关协议BGP（注意区别EGP外部网关协议），应用层协议，基于TCP，路径可能非最佳
## 其他
- IP组播
  - 只用于UDP，使用因特网组管理协议IGMP，不产生差错报文
  - IP地址：D类 224.0.0.0 ~ 239.255.255.255
  - 硬件地址：01-00-5e + IP地址去掉前5位
  - 组播路由选择：找出以源主机为根节点的组播转发树
- 移动IP
  - 支持移动性的因特网体系结构与协议
  - 实现跨不同网段的漫游，移动节点，本地代理，外部代理
- 网络层设备：路由器
  - 连接异构网络，面向协议，进行路由转发（同网直接交付，非同网间接交付）
  - 结构：路由选择，分组转发，路由表
    - 路由选择：选择处理机（核心构件），根据指定的路由选择协议构造路由表，并更新、维护
    - 分组转发：交换结构（关键）、一组输入端口、一组输出端口，
    - 标准路由表项 = { 目的网络IP，子网掩码，下一跳IP，接口 }
    - 路由表 ≠转发表，但讨论原理时经常不做区分
- 8583协议
  - 基于ISO8583报文国际标准的包格式的通讯协议
  - 8583包最多由128个字段域组成，每个域都有统一的规定，并有定长与变长之分
  - 8583包前面一段为位图，它是打包解包确定字段域的关键代替
  - 8583协议多在POS机的开发上使用。


# 五、传输层
- 承上启下，连接通信部分和用户功能部分：通信子网-下三层 and 资源子网-上三层
- 实现进程之间的逻辑通信，即端到端，形成水平逻辑通路（网络层实现主机之间逻辑通信）
- 传输层功能
  - 复用和分用
    - 复用：不同进程可以用同一个传输层协议
    - 分用：接受方的传输层能把去首部的数据正确交付到应用进程
  - 对报文包括首部、数据部分进行差错检测（网络层只查IP首部）
  - 同时提供2种传输协议（网络层同时只能存在一种）
    - 面向连接 TCP 可靠传输：适于可靠性更重要时，文件传输协议FTP、超文本传输协议HTTP、远程登录telnet等
    - 无连接 UDP 不可靠传输：适于实时性更重要时，小文件传送协议TFTP、DNS、SNMP、实时协议RTP
- 应用进程在传输层的标识：软件端口
  - 传输层通过端口判断将数据送到何处，长度 16 bit ，能表示2^16个端口号
  - 服务器端使用端口号
    - 熟知端口号：0~1023，互联网地址指派机构IANA 指派给TCP/IP最重要的一些应用程序
    - 登记端口号：1024~49151，在IANA登记后可使用
    - 熟知中常见的服务端口：FTP-21，SSH-22，TELNET-23，SMTP-25，DNS-53，TFTP-69，HTTP-80，SNMP-161
  - 客户端使用端口号：49152~65535，即短暂端口号or临时端口
- 套接字（通信端点）
  - 唯一标识网络中的一个主机上的一个应用
  - 套接字 Socket = （主机IP地址，端口号）
## UDP 用户数据报协议 User Datagram Protocol
- 首部协议字段 17，面向报文
- 无连接，不可靠，尽最大努力交付，无拥塞控制
  - 上层报文添加首部后原封不动直接下送，一次交付一个完整报文
  - 报文：UDP数据报处理的最小单位
- 首部固定 8 字节：2B源端口，2B目的端口，2BUDP长度（首部+数据），2BUDP检验和（可选全0）
- UDP校验
  - 数据报前增加 12B 伪首部 = 源IP + 目的IP + 0 + 17 + UDP长度
  - 首部、数据部分，一起校验
  - 查错不纠错，有错丢弃
## TCP 传输控制协议 Transmission-Control-Protocol
- 首部协议字段 6，面向字节流
- 连接，可靠，保障传输的“可靠、有序、无丢失、不重复”
  - 报文段：TCP传送的数据单元
  - 数据字段最大长度 = 最大报文段长度 MSS Maximum-Segment-Size
- 首部固定 20 字节，全双工通信，点对点，发送端and接收端设置缓存，累计确认
  - 2B 源端口，2B目的端口
  - 4B 序号 seq：本报文段发送数据的第一个字节的序号（TCP数据流每个字节都编序号，起始序号连接时建立）
  - 4B 确认号 ack：希望收到对方的下一个报文段数据的第一个字节的序号
  - 4位 首部长度/数据偏移：报文段数据距离报文段起始的距离
  - 6位 保留字段
  - 1b 紧急位 URG：URG=1时配合紧急指针，数据从第一个字节到紧急指针处为紧急数据，传送优先级高
  - 1b 确认位 ACK：ACK=1时确认号有效有意义，建立连接后所有传送的报文段ACK必为1
  - 1b 推送位 PSH：PSH=1时尽快向上交付应用进程
  - 1b 复位位 RST：RST=1时TCP严重差错，必须释放连接再重新建立
  - 1b 同步位 SYN：SYN=1时表示连接请求（ACK=0）or连接接收报文（ACK=1）
  - 1b 终止位 FIN：FIN=1时要求释放连接
  - 2B 窗口字段：当前允许对方发送的数据量，即给发送方设置的发送窗口，单位：字节
  - 2B 校验和：校验首部、数据，加12B伪首部进行校验
  - 2B 紧急指针：指出紧急数据字节数？
- TCP 连接管理
  - 连接建立、数据传送、连接释放，客户Client/服务器Server方式
  - TCP连接的端口：套接字socket/插口，唯一确定一条TCP连接
  - 相关：SYN 同步位，ACK 确认位，FIN 终止位，seq 序号（起始、随机），ack 确认号
  - 建立连接：三次握手（考虑改表格）
    - 客户端：SYN = 1，seq = x，                          发连接请求报文段，进入SYN_SEND状态
    - 服务器：SYN = 1，seq = y，    ACK = 1，ack = x + 1，收，回一个确认报文段
    - 客户端：         seq = x + 1，ACK = 1，ack = y + 1，收，回一个确认报文段，进入established状态
  - 释放连接：四次挥手
    - u、v、w = 1 + 该端已发数据最后一个字节的序号
    - 一端A请求终止，FIN = 1，seq = u                          ，A端不能再发数据，B端还可以
    - 对端B收和回复，         seq = v，    ACK = 1，ack = u + 1，A到B连接释放，B还可以发数据
    - 对端B请求终止，FIN = 1，seq = w，    ACK = 1，ack = u + 1，B端不能再发数据
    - 一端A收和回复，         seq = u + 1，ACK = 1，ack = w + 1，A发确认后等待2MSL时间后，B到A的连接释放
- TCP 可靠传输
  - 序号：保证数据有序
  - 确认
    - 利用确认号，TCP默认使用累计确认
    - 只确认到数据流中第一个丢失的字节、即期望收到的下一个报文段，而失序的报文先缓存起来
    - GBN（后退N帧ARQ协议）序的就丢弃
  - 重传
    - 超时重传：RTTs = (1-a)*OLD + a*NEW
    - 冗余ACK
      - 收到＞期望序号的失序报文段时，发送一个冗余ACK指明下一个期待字节的序号
      - 收到对同一报文段的3个冗余ACK，认为该报文段之后直连的报文段已丢失，如收到3个1号的，则算2号丟
      - 冗余ACK同时用在“拥塞控制”的“快重传”
- TCP 流量控制（利用滑动窗口机制）
  - 控制端到端用户之间，发送方发送速率、接收方读取速率的匹配，防止发送方使接收方缓存溢出
  - 接收窗口 rwnd：r即receive 即接收方报文头的“窗口”字段，发送方根据rwnd调整自己的发送窗口大小
  - 发送窗口实际上限 = Min｛rwnd，cwnd｝，单位：最大报文段长度MSS
  - 数据链路层的流量控制：定义相邻结点的流量控制，窗口大小不变
- TCP 拥塞控制
  - 全局性过程，防止网络中路由器、链路过载
  - 拥塞窗口 cwnd：c即congest 发送方估计当前网络的拥塞程度而确定，与网络带宽、时延有关
  - AIMD算法？additive increase multiplicative decrease 加法增大、乘法减小
  - 慢开始 + 拥塞避免（应对超时）
    - 流程：慢开始 →过门限则加法增大 →拥塞则乘法减小 →慢开始
    - 门限阈值 ssthresh，n个传输轮次 = n个往返时延RTT
    - 慢开始：随RTT“指数增长”，置发送方拥塞窗口 = 1 →收到一个确认则cwnd++
      - 注：cwnd = x，则可按发送时延发送 x 个报文段，故在一个往返时延内，若连续发送，能收到 x 个返回确认
      - 故经过一个RTT后，cwnd增加x，即cwnd = 2*cwnd，为随RTT的指数增长
    - 拥塞避免
      - “加法增大”：当cwnd ≥ssthresh，收到一个确认 cwnd++
      - “乘法减小”：当出现超时，ssthresh = cwnd / 2
    - 网络拥塞处理：无论何时，检测到超时且 cwnd ≥2，就 ssthresh = cwnd / 2 后 cwnd = 1
  - 快重传 + 快恢复（应对冗余ACK，对只有慢开始、拥塞避免的改进）
    - 流程：慢开始 →过门限则加法增大 →3个ACK则乘法减小 →快重传、快恢复
    - 快重传：不等超时，利用ACK冗余，收到3个针对同一报文冗余ACK时直接重传对方期望的报文段
    - 快恢复：“乘法减小”，连续收到3个ACK冗余时，ssthresh = cwnd / 2 且 cwnd = cwnd / 2
  - 实际应用中这几种算法同时存在，分情况使用

# 六、应用层
- 网络应用模型：C/S-不平等，P2P-平等
- DNS 域名解析服务 Domain N？？
  - 域名结构：国家顶级域名 →通用顶级域名 →基础结构域名
  - 域名服务器：根域名服务器 →顶级域名服务器 →授权域名服务器 →本地域名服务器
  - 域名解析：递归查询-委托上级；递归and迭代结合-常用-上级指路
- FTP 文件传输 File T
  - 提供交互式访问，允许指明文件类型+格式，允许文件具有存取权限
  - 服务器端口：20-控制端口，21-数据传输
- client/server 客户服务器模型
- 电子邮件
  - 发：SMTP 25
  - 收：POP3 110，IMAP
  - 转化编码：MIME
- 万维网 WWW
  - URL 统一资源定位符 Uniform Resource Locator
  - HTTP 80 H啥啥
    - 无状态，面向文本，本身无连接-交换前不需先建立连接
    - 连接类型：持久-流水线方式/非流水线方式，非持久-每次单独建立
    - RTT计算？？
  - HTML H啥啥
  - 本地Cookie：存储于本地，HTTP报文中有Cookie编号


# 相关其他
## URL 统一资源定位符 Uniform Resource Locator
- URL：全球资源定位符的英文所写，浏览器中输入的地址
- URI是Web上可用的每种资源
- - HTML文档、图像、视频片段、程序,由一个通过通用资源标志符(Universal Resource Identifier, 简称"URI")进行定位。 
- URL的格式由下列三部分组成: 
  - 第一部分：协议(或称为服务方式);
  - 第二部分：存有该资源的主机IP地址(有时也包括端口号);
  - 第三部分：主机资源的具体地址。
- URI一般由三部分组成: 
  - 访问资源的命名机制。
  - 存放资源的主机名。
  - 资源自身的名称，由路径表示。
- URI 是从虚拟根路径开始的，URL是整个链接
## Servlet原理
- C/B 请求 → server服务端（含tomcat → servlet） → 结果返回C/B
- servlet 线程池
  - 对于tomcat每次的请求都给他分配一个线程，用完将线程返回servlet
## tomcat
- 安装
  - /bin：startup.bat/sh开启 shutdown.sh/bat关闭
  - webapp/
  - config/：service.xml全局配置文件，一般不在这里进行详细配置 各种配置文件.xml catalina/目录配置文件.xml
## 金融类
- cics
- SOAP通信

